/*
---
description: With mBox.Modal.Confirm you can attach confirm dialogs to links or other DOM elements.

authors: Stephan Wagner

license: MIT-style

requires:
 - mBox
 - mBox.Modal
 - core/1.4.5: '*'
 - more/Element.Measure

provides: [mBox.Modal.Confirm]

documentation: http://htmltweaks.com/mBox/Documentation/Modal
...
*/
mBox.Modal.Confirm=new Class({Extends:mBox.Modal,options:{addClass:{wrapper:"Confirm"},buttons:[{addClass:"mBoxConfirmButtonCancel"},{addClass:"button_green mBoxConfirmButtonSubmit",event:function(e){this.confirm()}}],confirmAction:function(){},preventDefault:true,constructOnInit:true},initialize:function(e){this.defaultSubmitButton="Yes";this.defaultCancelButton="No";e.onSystemCloseComplete=function(){this.destroy()};e.onSystemBoxReady=function(){this.addButtons(this.options.buttons)};this.parent(e)},confirm:function(){eval(this.options.confirmAction);this.close()}});mBox.addConfirmEvents=function(){$$("*[data-confirm]").each(function(e){if(!e.retrieve("hasConfirm")){var t=e.getAttribute("data-confirm").split("|"),n=e.getAttribute("data-confirm-action")||(e.get("href")?'window.location.href = "'+e.get("href")+'";':"function() {}");e.addEvent("click",function(e){e.preventDefault();if(r){r.close(true)}var r=(new mBox.Modal.Confirm({content:t[0],confirmAction:n,onOpen:function(){if(!this.footerContainer){return;this.setFooter(null)}this.footerContainer.getElement(".mBoxConfirmButtonSubmit").set("html","<label>"+(t[1]||this.defaultSubmitButton)+"</label>");this.footerContainer.getElement(".mBoxConfirmButtonCancel").set("html","<label>"+(t[2]||this.defaultCancelButton)+"</label>")}})).open()});e.store("hasConfirm",true)}})};window.addEvent("domready",function(){mBox.addConfirmEvents()})